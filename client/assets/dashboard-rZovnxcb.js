import{a as t,j as e}from"./index-Cg5R3hIZ.js";import{u as h,a as j}from"./auth-context-BQBhOI20.js";import{U as y}from"./user-profile-CsyVOoie.js";function N(){const{user:a,userProfile:s,refreshProfile:g}=h(),[p,n]=t.useState(!1),[i,d]=t.useState(!1),[l,c]=t.useState(s?.name||""),[o,m]=t.useState(s?.year||new Date().getFullYear()),u=t.useId(),x=t.useId(),b=async()=>{if(!(!a||!l.trim()))try{d(!0),await j(a.uid,{name:l.trim(),year:o}),await g(),n(!1)}catch(r){console.error("Error updating profile:",r),alert("プロフィールの更新に失敗しました")}finally{d(!1)}},f=()=>{c(s?.name||""),m(s?.year||new Date().getFullYear()),n(!1)};return!a||!s?null:e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h3",{className:"mb-4 font-semibold text-gray-900 text-lg",children:"プロフィール編集"}),p?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:u,className:"mb-1 block font-medium text-gray-700 text-sm",children:"名前"}),e.jsx("input",{type:"text",id:u,value:l,onChange:r=>c(r.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"名前を入力"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:x,className:"mb-1 block font-medium text-gray-700 text-sm",children:"年度"}),e.jsx("input",{type:"number",id:x,value:o,onChange:r=>m(Number(r.target.value)),className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",min:"2000",max:"2050"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:b,disabled:i||!l.trim(),className:"rounded-md bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-50",children:i?"保存中...":"保存"}),e.jsx("button",{type:"button",onClick:f,disabled:i,className:"rounded-md bg-gray-300 px-4 py-2 text-gray-700 hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:opacity-50",children:"キャンセル"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700 text-sm",children:"名前"}),e.jsx("p",{className:"text-gray-900",children:s.name||"未設定"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700 text-sm",children:"Gmail"}),e.jsx("p",{className:"text-gray-900",children:s.gmail})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700 text-sm",children:"年度"}),e.jsx("p",{className:"text-gray-900",children:s.year})]}),e.jsx("button",{type:"button",onClick:()=>n(!0),className:"rounded-md bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"編集"})]})]})}function v({children:a}){return e.jsx(e.Fragment,{children:a})}function C(){return[{title:"ダッシュボード - React Router App"},{name:"description",content:"ユーザーダッシュボード"}]}function E(){const{user:a,userProfile:s}=h();return e.jsx(v,{children:e.jsx("div",{className:"min-h-screen bg-gray-100 py-8",children:e.jsxs("div",{className:"mx-auto max-w-4xl px-4",children:[e.jsx("h1",{className:"mb-8 font-bold text-3xl text-gray-900",children:"ダッシュボード"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6 md:col-span-1",children:[a&&e.jsx(y,{user:a,userProfile:s}),e.jsx(N,{})]}),e.jsxs("div",{className:"space-y-6 md:col-span-2",children:[e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-md",children:[e.jsxs("h2",{className:"mb-4 font-semibold text-gray-900 text-xl",children:["ようこそ、",s?.name||a?.displayName||"ユーザー","さん！"]}),e.jsx("p",{className:"text-gray-600",children:"Firebase AuthenticationとFirestore Databaseを使用した認証・データ管理システムが正常に動作しています。"})]}),e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h3",{className:"mb-3 font-semibold text-gray-900 text-lg",children:"機能"}),e.jsxs("ul",{className:"space-y-2 text-gray-600",children:[e.jsx("li",{children:"✅ Googleアカウントでのログイン"}),e.jsx("li",{children:"✅ 認証状態の管理"}),e.jsx("li",{children:"✅ 保護されたルート"}),e.jsx("li",{children:"✅ Firestoreへのユーザーデータ保存"}),e.jsx("li",{children:"✅ ユーザープロフィール表示・編集"}),e.jsx("li",{children:"✅ 最終ログイン時刻の記録"}),e.jsx("li",{children:"✅ ログアウト機能"})]})]})]})]})]})})})}export{E as default,C as meta};
